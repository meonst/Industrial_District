<!doctype html>

<title> silvercity </title>
<link rel='stylesheet' type='text/css' href='{{ cssURL }}'>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<script src='{{ jsURL }}'></script>

<body>
    <form method = "POST" enctype = "multipart/form-data">
        <input id="chooseReplay" type = "file" name = "file" value = "Choose Replay" accept=".StormReplay"/>
        <input id="submitReplay" type = "submit" name = "submit" value = "submit replay" formaction="/"/>
    </form>
</body>

<br>
<p>This game was played on {{ mapName }}</p>
<button onclick='toggle("stats")'>stats</button>
<button onclick='toggle("talents")'>talents</button>
<button onclick='toggle("chatlog")'>chatlog</button>
<button onclick='toggle("statistics")'>statistics</button>
<button onclick='toggle("charts")'>charts</button>

<pre id='stats'>
    <table>
    <tr id='Players'>
        <th id='playerRow'>Players</th> {% for i in nameList %} <th id='playerRow'>{{ i }}</th> {% endfor %}
    </tr>
    <tr id='Heroes'>
        <th>Heroes</th> {% for i in heroList %} <th>{{ i }}</th> {% endfor %}
    </tr>
    {% for i in stats %}
    <tr>
        <th id='Rows'>{{ i }}</th> {% for j in stats[i] %} <th>{{ j }}</th> {% endfor %}
    </tr>
    {% endfor %}
    </table>
</pre>

<pre id='talents'>
    {% for i in talents %}
    {{ i }}<a href="{{ talents[i] }}">{{ talents[i] }}</a>
    {% endfor %}
</pre>

<pre id='chatlog'>
    {% if chatlog %}
    {{chatlog}}
    {% endif %}
</pre>

<pre id='statistics'>
    <table>
        <tr>
            <th>Players</th> {% for i in nameList %} <th>{{ i }}</th> {% endfor %}
        </tr>
        <tr>
            <th>Heroes</th> {% for i in heroList %} <th>{{ i }}</th> {% endfor %}
        </tr>
        {% for i in statistics %}
        <tr>
            <th>{{ i }}</th> {% for j in statistics[i] %} <th>{{ j }}</th> {% endfor %}
        </tr>
        {% endfor %}
        </table>
</pre>

<pre id='charts'>
    <canvas id='blueExp'></canvas>
    <canvas id='redExp'></canvas>

    <canvas id='blueSiegeDmg'></canvas>
    <canvas id='redSiegeDmg'></canvas>

    <canvas id='blueHeroDmg'></canvas>
    <canvas id='redHeroDmg'></canvas>

    <canvas id='blueDeathTime'></canvas>
    <canvas id='redDeathTime'></canvas>

    <canvas id='blueDmgTaken'></canvas>
    <canvas id='redDmgTaken'></canvas>

    <canvas id='blueTeamFightDmgTaken'></canvas>
    <canvas id='redTeamFightDmgTaken'></canvas>

    <canvas id='blueTeamFightDmg'></canvas>
    <canvas id='redTeamFightDmg'></canvas>

    <canvas id='blueMinionKills'></canvas>
    <canvas id='redMinionKills'></canvas>
</pre>

<script>
    var pieColor = [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                ]
    var blueExpCanvas = document.getElementById('blueExp');
    var blueExpContributionChart = new Chart(blueExpCanvas, {
        type: 'pie',
        data: {
            labels: [
                {% for i in range(0, 5) %}
                '{{ nameList[i] }}({{ heroList[i] }})',
                {% endfor %} 
            ],
            datasets: [{
                label: 'exp contribution',
                data: [
                    {% for i in range(0, 5) %}
                    '{{ stats['ExperienceContribution'][i] }}',
                    {% endfor %}
                ],
                backgroundColor: pieColor,
            }]
        },
    });
    
    var redExpCanvas = document.getElementById('redExp');
    var redExpContributionChart = new Chart(redExpCanvas, {
        type: 'pie',
        data: {
            labels: [
                {% for i in range(5, 10) %}
                '{{ nameList[i] }}({{ heroList[i] }})',
                {% endfor %} 
            ],
            datasets: [{
                label: 'exp contribution',
                data: [
                    {% for i in range(5, 10) %}
                    '{{ stats['ExperienceContribution'][i] }}',
                    {% endfor %}
                ],
                backgroundColor: pieColor,
            }]
        },
    });


</script>