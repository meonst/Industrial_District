<!doctype html>

<title> silvercity </title>
<link rel="stylesheet" type="text/css" href="{{ css_URL }}">
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" src="{{ js_URL }}"></script>

<body>
    <form method = "POST" enctype = "multipart/form-data">
        <input id="choose_replay" type = "file" name = "file" value = "choose Replay" accept=".StormReplay"/>
        <input id="submit_replay" type = "submit" name = "submit" value = "submit replay" formaction="/"/>
    </form>
</body>

<br>
<p>{{ game_details["game_mode"] }} {{ game_details["game_time"] }} {{ game_details["map_name"] }} {{ game_details["game_length"] }} {{ game_details["game_version"] }}</p>
<button onclick="toggle('stats')">stats</button>
<button onclick="toggle('talents')">talents</button>
<button onclick="toggle('chatlog')">chatlog</button>
<button onclick="toggle('statistics')">statistics</button>

<pre id="stats">
    <table>
    <tr id="players">
        <th id="player_row">Players</th> {% for i in range(0, 10) %} <th id="player_row">{{ players[i]["player_name"] }}</th> {% endfor %}
    </tr>
    <tr id="heroes">
        <th id="hero_row">Heroes</th> {% for i in range(0, 10) %} <th>{{ players[i]["hero_name"] }}</th> {% endfor %}
    </tr>
    {% for i in stats %}
    <tr>
        <th id="rows">{{ i }}</th> {% for j in stats[i] %} <th>{{ j }}</th> {% endfor %}
    </tr>
    {% endfor %}
    </table>
</pre>

<pre id="talents">{% for i in range(0, 10) %}<div id="talents_player_{{ players[i]['team'] }}"><img id="talents_player_portrait" src="https://min.hyeok.org/SILVER/files/images/heroportraits/{{ players[i]['party_panel_portrait'] }}"><div id=talents_player_name>{{ players[i]["player_name"] }}
{{ players[i]["hero_name"] }}</div><a id="talents_player_icon_box" href="https://min.hyeok.org/SILVER/#/{{ players[i]['hero_link'] }}/{{ players[i]['talent'] }}">{% for j in range(0, 7) %}<img id="talents_player_icon_box_individual" src="https://min.hyeok.org/SILVER/files/images/abilitytalents/{{ players[i]['talent_icon'][j] }}">{% endfor %}</a></div>{% endfor %}</pre>

<pre id="chatlog">
    {% if chatlog %}
        {{chatlog}}
    {% endif %}
</pre>

<pre id="statistics">
    <table>
        <tr id="Players">
            <th id="player_row">Players</th> {% for i in range(0, 10) %} <th id="playerRow">{{ players[i]["player_name"] }}</th> {% endfor %}
        </tr>
        <tr id="Heroes">
            <th id="hero_row">Heroes</th> {% for i in range(0, 10) %} <th>{{ players[i]["hero_name"] }}</th> {% endfor %}
        </tr>
        {% for i in statistics %}
        <tr>
            <th>{{ i }}</th> {% for j in statistics[i] %} <th>{{ j }}</th> {% endfor %}
        </tr>
        {% endfor %}
    </table>
</pre>


<pre id="charts">
    <div id="charts_categories">{% for i in range(0, 8) %}<div id="checkbox_{{ chart_title[i] }}"><input type="checkbox" id="checkbox_{{ chart_title[i] }}_checkbox" class="chart_checkbox"> <label for="checkbox_{{ chart_title[i] }}_label">{{ chart_title[i] }}</label></div>{% endfor %} </div> 
    <div id="charts_players">{% for i in range(0, 10) %}<div id="charts_players_player_{{ i }}"><img id="charts_players_portrait" src="https://min.hyeok.org/SILVER/files/images/heroportraits/{{ players[i]['minimap_portrait'] }}"></div> {% endfor %}
    </div>
    <canvas id="charts_chart" width="700px" height="420px">        
    </canvas>
    {% for i in range(0, 8) %}
    {% for j in range(0, 5) %}
    <div id="charts_chart_{{ i }}_{{ j }}" style="display: none; background-color: blue;"></div>
    <div id="charts_chart_{{ i }}_{{ j + 5 }}" style="display: none; background-color: red"></div>
    {% endfor %}
    {% endfor %}


</pre>
<script type="text/javascript">
    const drawing = document.getElementById("charts_chart").getContext("2d");
    var checkbox_group = document.getElementsByClassName('chart_checkbox')
    var update = []
    var checked_cout = 0
    chart_checkbox_limit()

    {% for i in range(0, 8) %}
    update[{{ i }}] = document.getElementById("checkbox_{{ chart_title[i] }}_checkbox")
    update[{{ i }}].addEventListener("change", (event) => {
        graph_drawing()
    })
    {% endfor %}


    function graph_drawing() {
        {% for i in range(0, 8) %}
        
        if (checkbox_group[{{ i }}].checked == true) {
        
        console.log("{{ statistics[chart_link[i]] }}"))
        console.log("{{ statistics[chart_link[i]] }}")
        {% for j in range(0, 10) %}

        document.getElementById("charts_chart_{{ i }}_{{ j }}").style.display = "block"
        
        {% endfor %}   

        }
        else {        
            {% for j in range(0, 10) %}
            document.getElementById("charts_chart_{{ i }}_{{ j }}").style.display = "none" 
            {% endfor %}  
        }
        {% endfor %}
        

    }
    function chart_checkbox_limit() {
        
        for (var i = 0; i < checkbox_group.length; i++) {
            checkbox_group[i].onclick = function() {
                    checked_count = 0;
                    for (var i = 0; i < checkbox_group.length; i++) {
                    checked_count += (checkbox_group[i].checked) ? 1 : 0;
                }
                if (checked_count > 3) {
                    this.checked = false;
                    checked_count -= 1;
                }
            }
        }
    }
</script>



<meta id="replay_data" data="">